<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Modern Business - uim Framework</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="https://uimsolutions.github.io/uim/assets/favicon.ico" />
        <!-- Bootstrap icons-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" rel="stylesheet" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="https://uimsolutions.github.io/uim/css/styles.css" rel="stylesheet" />
    </head>
    <body class="d-flex flex-column">
        <main class="flex-shrink-0">
            <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container px-5">
        <a class="navbar-brand" href="index.html">uim</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
                <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
                <li class="nav-item"><a class="nav-link" href="faq.html">FAQ</a></li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" id="navbarDropdownBlog" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Packages</a>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdownBlog">
                        <li><a class="dropdown-item" href="blog-home.html">Blog Home</a></li>
                        <li><a class="dropdown-item" href="blog-post.html">Blog Post</a></li>
                    </ul>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" id="navbarDropdownBlog" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Blog</a>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdownBlog">
                        <li><a class="dropdown-item" href="blog-home.html">Blog Home</a></li>
                        <li><a class="dropdown-item" href="blog-post.html">Blog Post</a></li>
                    </ul>
                </li>
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" id="navbarDropdownPortfolio" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Portfolio</a>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdownPortfolio">
                        <li><a class="dropdown-item" href="portfolio-overview.html">Portfolio Overview</a></li>
                        <li><a class="dropdown-item" href="portfolio-item.html">Portfolio Item</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>	

            <!-- Header-->
            <header class="py-5">
                <div class="container px-5">
                    <div class="row justify-content-center">
                        <div class="col-lg-8 col-xxl-6">
                            <div class="text-left my-5">
                                <nav aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="https://uimsolutions.github.io/uim/api/index.html">API</a></li><li class="breadcrumb-item"><a href="https://uimsolutions.github.io/uim/api/uim/index.html">uim</a></li><li class="breadcrumb-item"><a href="https://uimsolutions.github.io/uim/api/uim/errors/index.html">errors</a></li><li class="breadcrumb-item"><a href="https://uimsolutions.github.io/uim/api/uim/errors/classes/index.html">classes</a></li><li class="breadcrumb-item"><a href="https://uimsolutions.github.io/uim/api/uim/errors/classes/exceptions/index.html">exceptions</a></li><li class="breadcrumb-item active" aria-current="page">trap</li></ol></nav>
                                <h1 class="fw-bolder mb-3">Class DExceptionTrap</h1>
                                <table><tr><td>super:UIMObject</td></tr><tr><td>filepath:C:\Users\ONS\PROJECTS2023\uim\errors\uim\errors\classes\exceptions\trap.d</td></tr><tr><td>parents:["UIMObject"]</td></tr><tr><td>namespace:uim.errors.classes.exceptions.trap</td></tr><tr><td>name:DExceptionTrap</td></tr><tr><td>content:["    mixin TEventDispatcher;","    this() {","        super();","    }","    this(Json[string] initData) {","        super(initData);","    }","    this(string newName, Json[string] initData = null) {","        super(newName, initData);","    }","    // Hook method","    override bool initialize(Json[string] initData = null) {","        if (!super.initialize(initData)) {","            return false;","        }","    /**","     * Configuration options. Generally these will be defined in your config/app.D","     *","     * - `exceptionRenderer` - string - The class responsible for rendering uncaught exceptions.","     *  The chosen class will be used for for both CLI and web environments. If  you want different","     *  classes used in CLI and web environments you\"ll need to write that conditional logic as well.","     *  The conventional location for custom renderers is in `src/Error`. Your exception renderer needs to","     *  implement the `render()` method and return either a string or Http\\Response.","     * - `log` Set to false to disable logging.","     * - `logger` - string - The class name of the error logger to use.","     * - `trace` - boolean - Whether or not backtraces should be included in","     *  logged exceptions.","     * - `skipLog` - array - List of exceptions to skip for logging. Exceptions that","     *  extend one of the listed exceptions will also not be logged. E.g.:","     *  ```","     *  \"skipLog\": [\"uim\\Http\\exceptions.NotFoundException\", \"uim\\Http\\exceptions.UnauthorizedException\"]","     *  ```","     *  This option is forwarded to the configured `logger`","     * - `extraFatalErrorMemory` - int - The number of megabytes to increase the memory limit by when a fatal error is","     *  encountered. This allows breathing room to complete logging or error handling.","     * - `stderr` Used in console environments so that renderers have access to the current console output stream.","     */","    configuration","        .setDefault(\"exceptionRenderer\", Json(null))","        .setDefault(\"logger\", ErrorLogger.classname)","        .setDefault(\"stderr\", Json(null))","        .setDefault(\"log\", true)","        .setDefault(\"skipLog\", Json.emptyArray)","        .setDefault(\"trace\", false)","        .setDefault(\"extraFatalErrorMemory\", 4);","        return true;","    }","    /**","     * A list of handling callbacks.","     *","     * Callbacks are invoked for each error that is handled.","     * Callbacks are invoked in the order they are attached.","     *","     * @var array<\\Closure>","     */","    protected IClosure callbacks = null;","    /**","     * The currently registered global exception handler","     *","     * This is best effort as we can\"t know if/when another","     * exception handler is registered.","     *","     * @var uim.errors.ExceptionTrap|null","     */","    protected static registeredTrap = null;","    // Track if this trap was removed from the global handler.","    protected bool disabled = false;","    // Get an instance of the renderer.","    IExceptionRenderer renderer(Throwable exceptionToRender, IServerRequest serverRequest = null) {","        /* serverRequest = serverRequest ? serverRequest : Router.getRequest();","        /** @var class-string|callable aclassname * /","        aclassname = configuration.get(\"exceptionRenderer\");","        deprecateDFileConfigEngine = (aclassname == ExceptionRenderer.classname && D_SAPI == \"cli\");","        if (deprecateDFileConfigEngine) {","            deprecationWarning(","                \"Your application is using a deprecated `Error.exceptionRenderer`~ \" ~","                \"You can either remove the `Error.exceptionRenderer` config key to have UIM choose \" ~","                \"one of the default exception renderers, or define a class that is not `uim\\errors.ExceptionRenderer`.\"","           );","        }","        if (!aclassname || deprecateDFileConfigEngine) {","            // Default to detecting the exception renderer if we\"re","            // in a CLI context and the Web renderer is currently selected.","            // This indicates old configuration or user error, in both scenarios","            // it is preferrable to use the Console renderer instead.","            aclassname = this.chooseRenderer();","        }","        if (aclassname.isString) {","            /** @psalm-suppress ArgumentTypeCoercion * /","            if (!(hasMethod(aclassname, \"render\") && hasMethod(aclassname, \"write\"))) {","                throw new DInvalidArgumentException(","                    \"Cannot use {aclassname} as an `exceptionRenderer`~ \" ~","                    \"It must implement render() and write() methods.\"","               );","            }","            /** @var class-string<uim.errors.IExceptionRenderer> aclassname * /","            return new aclassname(exception, serverRequest, _config);","        }","        return aclassname(exception, serverRequest); */","        return null;","    }","    // Choose an exception renderer based on config or the SAPI","    protected string chooseRenderer() {","        /** @var class-string<uim.errors.IExceptionRenderer> */","        return D_SAPI == \"cli\" ? ConsoleExceptionRenderer.classname : ExceptionRenderer.classname;","    }","    // Get an instance of the logger.","    IErrorLogger logger() {","        /** @var class-string<uim.errors.IErrorLogger> aclassname */","        auto aclassname = configuration.get(\"logger\", _defaultConfig[\"logger\"]);","        return new aclassname(_config);","    }","    /**","     * Attach this ExceptionTrap to D\"s default exception handler.","     *","     * This will replace the existing exception handler, and the","     * previous exception handler will be discarded.","     */","    void register() {","        set_exception_handler([this, \"handleException\"]);","        register_shutdown_function([this, \"handleShutdown\"]);","        registeredTrap = this;","    }","    /**","     * Remove this instance from the singleton","     *","     * If this instance is not currently the registered singleton","     * nothing happens.","     */","    void unregister() {","        if (registeredTrap == this) {","            _disabled = true;","            registeredTrap = null;","        }","    }","    /**","     * Get the registered global instance if set.","     *","     * Keep in mind that the global state contained here","     * is mutable and the object returned by this method","     * could be a stale value.","     */","    static ExceptionTrap instance() {","        return registeredTrap;","    }","    /**","     * Handle uncaught exceptions.","     *","     * Uses a template method provided by subclasses to display errors in an","     * environment appropriate way.","     */","    void handleException(Throwable exception) {","        /* if (_disabled) {","            return;","        }","        auto request = Router.getRequest();","        logException(exception, request);","        try {","            renderer = this.renderer(exception);","            renderer.write(renderer.render());","        } catch (Throwable exception) {","            this.logInternalError(exception);","        }","        // Use this constant as a proxy for uimD tests.","        if (D_SAPI == \"cli\" && !env(\"FIXTURE_SCHEMA_METADATA\")) {","            exit(1);","        } */","    }","    /**","     * Shutdown handler","     *","     * Convert fatal errors into exceptions that we can render.","     */","    void handleShutdown() {","        /* if (_disabled) {","            return;","        }","        megabytes = _config[\"extraFatalErrorMemory\"] ?? 4;","        if (megabytes > 0) {","            this.increaseMemoryLimit(megabytes * 1024);","        }","        error = error_get_last();","        if (!error.isArray) {","            return;","        }","        fatals = [","            ERRORS.USER_ERROR,","            ERRORS.ERROR,","            ERRORS.PARSE,","        ];","        if (!hasAllValues(error[\"type\"], fatals, true)) {","            return;","        }","        this.handleFatalError(","            error[\"type\"],","            error[\"message\"],","            error[\"file\"],","            error[\"line\"]","       ); */","    }","    // Increases the UIM \"memory_limit\" ini setting by the specified amount in kilobytes","    void increaseMemoryLimit(int additionalKb) {","        /* auto limit = ini_get(\"memory_limit\");","        if (limit.isEmpty || limit == \"-1\") {","            return;","        }","        limit = limit.strip;","        auto units = subString(limit, -1).upper;","        auto current = (int)subString(limit, 0, -1);","        if (units == \"M\") {","            current *= 1024;","            units = \"K\";","        }","        if (units == \"G\") {","            current = current * 1024 * 1024;","            units = \"K\";","        }","        if (units == \"K\") {","            ini_set(\"memory_limit\", ceil(current + additionalKb) ~ \"K\");","        } */","    }","    // Display/Log a fatal error.","    void handleFatalError(int errorCode, string errorDescription, string fileWithError, int errorLine) {","        this.handleException(new DFatalErrorException(\"Fatal Error: \" ~ description, 500, fileWithError, errorLine));","    }","    /**","     * Log an exception.","     *","     * Primarily a function to ensure consistency between global exception handling","     * and the ErrorHandlerMiddleware. This method will apply the `skipLog` filter","     * skipping logging if the exception should not be logged.","     *","     * After logging is attempted the `Exception.beforeRender` event is triggered.","     */","    void logException(Throwable exceptionToLog, IServerRequest serverRequest = null) {","        /* auto shouldLog = _config[\"log\"];","        if (shouldLog) {","            foreach (aclassname, configuration.get(\"skipLog\")) {","                if (cast(aclassname)exceptionToLog ) {","                    shouldLog = false;","                }","            }","        }","        if (shouldLog) {","            logger = logger();","            if (hasMethod(logger, \"logException\")) {","                logger.logException(exceptionToLog, serverRequest, _config[\"trace\"]);","            } else {","                loggerClass = get_class(logger);","                deprecationWarning(","                    \"The configured logger `{loggerClass}` should implement `logException()` \" ~","                    \"to be compatible with future versions of UIM.\"","               );","                logger().log(exceptionToLog, serverRequest);","            }","        }","        dispatchEvent(\"Exception.beforeRender\", [\"exception\": exceptionToLog]); */","    }","    /**","     * Trigger an error that occurred during rendering an exception.","     *","     * By triggering an ERRORS.USER_ERROR we can end up in the default","     * exception handling which will log the rendering failure,","     * and hopefully render an error page.","     */","    void logInternalError(Throwable exceptionToLog) {","        string message = \"[%s] %s (%s:%s)\".format( // Keeping same message format","            get_class(exceptionToLog),","            exceptionToLog.message(),","            exceptionToLog.getFile(),","            exceptionToLog.getLine(),","       );","        trigger_error(message, ERRORS.USER_ERROR);","    }"]</td></tr><tr><td>methods:[{"isProperty":false,"datatype":null,"name":"this","isAbstract":false,"isInherited":false,"header":"this()","isStatic":false},{"isProperty":false,"datatype":null,"name":"this","isAbstract":false,"isInherited":false,"header":"this(Json[string] initData)","isStatic":false},{"isProperty":false,"datatype":null,"name":"this","isAbstract":false,"isInherited":false,"header":"this(string newName, Json[string] initData = null)","isStatic":false},{"isProperty":false,"parameters":["Json[string] initData = null"],"datatype":"bool","name":"initialize","isAbstract":false,"isInherited":true,"header":"bool initialize(Json[string] initData = null)","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (!super.initialize(initData))","isStatic":false},{"isProperty":false,"parameters":["Throwable exceptionToRender","IServerRequest serverRequest = null"],"datatype":"IExceptionRenderer","name":"renderer","isAbstract":false,"isInherited":false,"header":"IExceptionRenderer renderer(Throwable exceptionToRender, IServerRequest serverRequest = null)","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (deprecateDFileConfigEngine)","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (!aclassname || deprecateDFileConfigEngine)","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (aclassname.isString)","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (!(hasMethod(aclassname, \"render\") && hasMethod(aclassname, \"write\")))","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"protected","name":"string chooseRenderer","isAbstract":false,"isInherited":false,"header":"protected string chooseRenderer()","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"IErrorLogger","name":"logger","isAbstract":false,"isInherited":false,"header":"IErrorLogger logger()","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"void","name":"register","isAbstract":false,"isInherited":false,"header":"void register()","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"void","name":"unregister","isAbstract":false,"isInherited":false,"header":"void unregister()","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (registeredTrap == this)","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"ExceptionTrap","name":"instance","isAbstract":false,"isInherited":false,"header":"ExceptionTrap instance()","isStatic":true},{"isProperty":false,"parameters":["Throwable exception"],"datatype":"void","name":"handleException","isAbstract":false,"isInherited":false,"header":"void handleException(Throwable exception)","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (D_SAPI == \"cli\" && !env(\"FIXTURE_SCHEMA_METADATA\"))","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"void","name":"handleShutdown","isAbstract":false,"isInherited":false,"header":"void handleShutdown()","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (megabytes > 0)","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (!error.isArray)","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (!hasAllValues(error[\"type\"], fatals, true))","isStatic":false},{"isProperty":false,"parameters":["int additionalKb"],"datatype":"void","name":"increaseMemoryLimit","isAbstract":false,"isInherited":false,"header":"void increaseMemoryLimit(int additionalKb)","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (limit.isEmpty || limit == \"-1\")","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (units == \"M\")","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (units == \"G\")","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (units == \"K\")","isStatic":false},{"isProperty":false,"parameters":["int errorCode","string errorDescription","string fileWithError","int errorLine"],"datatype":"void","name":"handleFatalError","isAbstract":false,"isInherited":false,"header":"void handleFatalError(int errorCode, string errorDescription, string fileWithError, int errorLine)","isStatic":false},{"isProperty":false,"parameters":["Throwable exceptionToLog","IServerRequest serverRequest = null"],"datatype":"void","name":"logException","isAbstract":false,"isInherited":false,"header":"void logException(Throwable exceptionToLog, IServerRequest serverRequest = null)","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (shouldLog)","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"foreach","name":"","isAbstract":false,"isInherited":false,"header":"foreach (aclassname, configuration.get(\"skipLog\"))","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (cast(aclassname)exceptionToLog )","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (shouldLog)","isStatic":false},{"isProperty":false,"parameters":[],"datatype":"if","name":"","isAbstract":false,"isInherited":false,"header":"if (hasMethod(logger, \"logException\"))","isStatic":false},{"isProperty":false,"parameters":[")` \" ~"],"datatype":"\"The","name":"configured logger `loggerClass}` should implement `logException","isAbstract":false,"isInherited":false,"header":"\"The configured logger `loggerClass}` should implement `logException()` \" ~","isStatic":false},{"isProperty":false,"parameters":["Throwable exceptionToLog"],"datatype":"void","name":"logInternalError","isAbstract":false,"isInherited":false,"header":"void logInternalError(Throwable exceptionToLog)","isStatic":false}]</td></tr><tr><td>type:class</td></tr></table>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            <!-- About section one-->
            <section class="py-5 bg-light" id="scroll-target">
                <div class="container px-5 my-5">
                </div>
            </section>
        </main>
        <!-- Footer-->
        <footer class="bg-dark py-4 mt-auto">
    <div class="container px-5">
        <div class="row align-items-center justify-content-between flex-column flex-sm-row">
            <div class="col-auto"><div class="small m-0 text-white">Copyright &copy; 2015 - 2024 Ozan Nurettin Süel</div></div>
            <div class="col-auto">
                <a class="link-light small" href="#!">Privacy</a>
                <span class="text-white mx-1">&middot;</span>
                <a class="link-light small" href="#!">Terms</a>
                <span class="text-white mx-1">&middot;</span>
                <a class="link-light small" href="#!">Contact</a>
            </div>
        </div>
    </div>
</footer>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
    </body>
</html>
